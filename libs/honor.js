!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.honor=t():e.honor=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),i=["SceneManager","DialogManager","LoadManager","AlertManager"],a={Scene:null,Dialog:null},s={},u={init:function(){for(var e=0,t=i;e<t.length;e++){var n=t[e],o=new Laya.Sprite;o.name="_$"+n,this[o.name]=o,console.log(n),Laya.stage.addChild(o)}},onResize:function(e,t){for(var n=0,o=i;n<o.length;n++){this["_$"+o[n]].size(e,t)}for(var r in a)if(a.hasOwnProperty(r)){var s=a[r];s&&(s.size(e,t),s.onResize&&s.onResize(e,t))}},_createLoadViewByClass:function(e,t,n){var o=Laya.stage,r=o.width,i=o.height;n.size(r,i),n.onReset&&n.onReset(),this.addView("Load",n),a[e]=n,t&&t.run()},_createLoadViewByData:function(e,t,n,o){var r=this;if(!o)throw new Error('Can not find "Scene":'+t);if(!o.props)throw new Error('"Scene" data is error:'+t);var i=o.props.runtime?o.props.runtime:o.type,a=Laya.ClassUtils.getClass(i);this.createView(o,a,t).then(function(t){r._createLoadViewByClass(e,n,t)})},recoverView:function(e){var t=e.url||e.constructor.name;s[t]||(s[t]=[]),s[t].push(e)},getViewByPool:function(e){return s[e]?s[e].pop():null},createView:function(e,t,n,o){return new Promise(function(r,i){var a=new t;if(o&&a.onMounted&&a.onMounted.apply(a,o),"instance"===e.props.renderType&&(a=t.instance||(t.instance=a)),a&&(a instanceof Laya.Scene||a instanceof Laya.Dialog))return a.url=n,void(a._getBit(8)?(a.on("onViewCreated",null,function(){r(a)}),a.createView(e)):r(a));throw new Error("Can not find Scene:"+n)})},setLoadView:function(e,t,n){var o=this;r.default.loadScene(null,t,function(r){o._createLoadViewByData(e,t,n,r)})},setLoadViewVisible:function(e,t){var n=a[e];n&&!n.destroyed&&(n.visible=t,t?n.onShow&&n.onShow():n.onReset&&n.onReset())},setLoadProgress:function(e,t){var n=a[e];n&&n.onProgress&&n.onProgress(t)},getView:function(e){return this["_$"+e+"Manager"]},setViewVisible:function(e,t){this["_$"+e+"Manager"].visible=t},addView:function(e,t){this["_$"+e+"Manager"].addChild(t)},addViewAt:function(e,t,n){this["_$"+e+"Manager"].addChildAt(t,n)}};t.default=u},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{u(o.next(e))}catch(e){i(e)}}function s(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(7),u={is_loading:!1},l={__init__:function(){},loadScene:function(e,t,n){var o=Laya.Loader.getRes(t);if(o)return n(o);this.toggleLoading(e,!0),Laya.loader.resetProgress();var r=new Laya.SceneLoader;r.on(Laya.Event.PROGRESS,this,this.onLoadProgress,[e]),r.once(Laya.Event.COMPLETE,this,this.onLoadComplete,[e,t,r,n]),r.load(t)},load:function(e,t){var n=this;return new Promise(function(i,l){return o(n,void 0,void 0,function(){var n;return r(this,function(o){switch(o.label){case 0:return this.toggleLoading(t,!0),t&&(n=function(e){a.default.setLoadProgress(t,e)}),u.is_loading=!0,[4,s.loadRes(e,n)];case 1:return o.sent(),this.toggleLoading(t,!1),u.is_loading=!1,[2,i()]}})})})},onLoadProgress:function(e,t){e&&a.default.setLoadProgress(e,t)},onLoadComplete:function(e,t,n,o){n.off(Laya.Event.PROGRESS,null,this.onLoadProgress),o(Laya.Loader.getRes(t)),e&&this.toggleLoading(e,!1)},toggleLoading:function(e,t){if(e){var n=0;!1===t&&(n=500),clearTimeout(this[e+"_timeout"]),this[e+"_timeout"]=setTimeout(function(){a.default.setLoadViewVisible(e,t)},n)}}};t.default=l},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{u(o.next(e))}catch(e){i(e)}}function s(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=i(n(1)),u={sceneChangeBeforeListener:[],sceneChangeAfterListener:[],sceneClassMap:{},_curScene:null,__init__:function(){},onResize:function(e,t){this._curScene&&(this._curScene.size(e,t),this._curScene.onResize&&this._curScene.onResize(e,t))},switchScene:function(e,t){var n=Laya.stage,o=n.width,r=n.height;t.size(o,r),t.onMounted&&t.onMounted.apply(t,e),a.default.addView("Scene",t);var i=this._curScene,s=i?i.url:null;return i&&(i.onClosed&&i.onClosed(),i.destroy()),this._curScene=t,{cur:t.url,prev:s}},callChangeListener:function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];"before"===e?t=this.sceneChangeBeforeListener:"after"===e&&(t=this.sceneChangeAfterListener);for(var r=0,i=t;r<i.length;r++){var a=i[r].apply(void 0,n);if(a)return a}},runScene:function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return new Promise(function(i,u){return o(t,void 0,void 0,function(){var t,o,l,c=this;return r(this,function(r){switch(r.label){case 0:return this.callChangeListener("before",this._curScene&&this._curScene.url,e)?[2,u()]:(t=a.default.getViewByPool(e))?(o=this.switchScene(n,t),[3,6]):[3,1];case 1:return"string"!=typeof e?[3,4]:[4,new Promise(function(t,n){s.default.loadScene("Scene",e,function(e){t(e)})})];case 2:return l=r.sent(),[4,this.runSceneByCtor(e,l)];case 3:return t=r.sent(),o=this.switchScene(n,t),[3,6];case 4:return"function"!=typeof e?[3,6]:(t=new e,[4,new Promise(function(e,n){t.once("onViewCreated",c,function(){return e()})})]);case 5:r.sent(),o=this.switchScene(n,t),r.label=6;case 6:return this.callChangeListener("after",o.cur,o.prev),[2,i(t)]}})})})},runSceneByCtor:function(e,t){var n=this;return new Promise(function(o,r){if(!t)throw new Error('Can not find "Scene":'+e);if(!t.props)throw new Error('"Scene" data is error:'+e);var i=t.props.runtime?t.props.runtime:t.type,s=Laya.ClassUtils.getClass(i);n.sceneClassMap[e]=s,a.default.createView(t,s,e).then(function(e){o(e)})})}};t.default=u},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(0)),a=n(5),s={init:function(){Laya.stage.on(Laya.Event.RESIZE,this,this.onResize),this.onResize()},onResize:function(){var e=Laya.stage,t=e.width,n=e.height;i.default.onResize(t,n),r.default.onResize(t,n),a.DialogManager.onResize(t,n)},runScene:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.default.runScene.apply(r.default,[e].concat(t)).catch(function(e){console.error("runScene interrupt")})},get runningScene(){return r.default._curScene},openDialog:function(e,t,n,o){return void 0===o&&(o=!1),a.DialogManager.openDialog(e,t,n,o)},getDialogByName:function(e){return a.DialogManager.getDialogByName(e)},getDialogsByGroup:function(e){return a.DialogManager.getDialogsByGroup(e)},closeDialogByName:function(e){a.DialogManager.closeDialogByName(e)},closeDialogsByGroup:function(e){a.DialogManager.closeDialogsByGroup(e)},closeAllDialogs:function(){a.DialogManager.closeAll()},setLoadPageForScene:function(e,t){i.default.setLoadView("Scene",e,t)},setLoadPageForDialog:function(e,t){i.default.setLoadView("Dialog",e,t)}};t.default=s},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=o(n(0)),a=o(n(2)),s=o(n(1)),u=o(n(3));t.initState=function(){i.default.init(),a.default.__init__(),s.default.__init__(),t.DialogManager=new r.DialogManager,t.DialogManager.init(),u.default.init()}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(3));t.director=i.default;var a=o(n(13));t.Utils=a.default;var s=o(n(1)),u=r(n(21));t.sceneChangeMonitor=u;var l=n(5),c=o(n(0));t.DirectorView=c.default;t.name="Honor";t.version="0.0.1-beta";var f=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.default.load.apply(s.default,e)};t.load=f;var d=!1;function h(e,n){n?Laya.View?(window.Laya3D?Laya3D.init(e.width,e.height):Laya.init(e.width,e.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=e.scaleMode,Laya.stage.screenMode=e.screenMode,Laya.stage.alignV=e.alignV,Laya.stage.alignH=e.alignH,Laya.URL.exportSceneToJson=e.exportSceneToJson,e.debug||"true"==Laya.Utils.getQueryString("debug")?(t.DEBUG_MODE=d=!0,Laya.enableDebugPanel()):t.DEBUG_MODE=d=!1,e.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),Laya.alertGlobalError=!1,Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(null,function(){l.initState(),n()}))):console.error("需要laya.ui库"):console.error("需要引擎启动以后的回调函数，用来启动起始页等")}t.DEBUG_MODE=d,t.run=h,t.Honor={name:"Honor",version:"0.0.1-beta",run:h,director:i.default,Utils:a.default,load:f,sceneChangeMonitor:u,DirectorView:c.default,DEBUG_MODE:d}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.loadRes=function(t,n){var o=this;return new Promise(function(r,i){var a;n&&(a=new Laya.Handler(null,function(e){n(e)},null,!1));var s=new Laya.Handler(o,function(){e(r)});Laya.loader.load(t,s,a)})}}).call(this,n(8).setImmediate)},function(e,t,n){(function(e){var o=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(r.call(setTimeout,o,arguments),clearTimeout)},t.setInterval=function(){return new i(r.call(setInterval,o,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(o,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(9),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var o,r,i,a,s,u=1,l={},c=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?o=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},o=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(r=f.documentElement,o=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):o=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),o=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return l[u]=r,o(u),u++},d.clearImmediate=h}function h(e){delete l[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o)}}(t)}finally{h(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(4),n(10))},function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var u,l=[],c=!1,f=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):f=-1,l.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=l.length;t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,c=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{u(o.next(e))}catch(e){i(e)}}function s(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=u(n(0)),c=n(12),f=u(n(1)),d=Laya.Tween,h=Laya.Sprite,p=function(e){e.scale(1,1),e._effectTween=Laya.Tween.from(e,{x:Laya.stage.width/2,y:Laya.stage.height/2,scaleX:0,scaleY:0},300,Laya.Ease.backOut,Laya.Handler.create(this,this.doOpen,[e]),0,!1,!1)},g=function(e){e._effectTween=Laya.Tween.to(e,{x:Laya.stage.width/2,y:Laya.stage.height/2,scaleX:0,scaleY:0},300,Laya.Ease.backIn,Laya.Handler.create(this,this.doClose,[e]),0,!1,!1)},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.wait_open_dialog_map=new Map,t.dialog_list=[],t}return r(t,e),t.prototype.init=function(){this.maskLayerName="__$DialogManagerMaskLayer:"+Math.random(),this.popupEffectHandler=new Laya.Handler(this,p),this.closeEffectHandler=new Laya.Handler(this,g),this.maskLayer=new h,this.maskLayer.on("click",this,this.closeOnSide),this.maskLayer.name=this.maskLayerName,l.default.addView("Dialog",this.maskLayer),l.default.setViewVisible("Dialog",!1),this.viewContent=l.default.getView("Dialog"),this.viewContent.mouseThrough=!0,Laya.Dialog.manager=this},t.prototype.getDialogConfig=function(e){for(var t=0,n=this.dialog_list;t<n.length;t++){var o=n[t];if(o.dialog===e)return o.config}},t.prototype.closeOnSide=function(){var e=this.viewContent,t=e.getChildAt(e.numChildren-1),n=this.getDialogConfig(t);t instanceof laya.ui.Dialog&&t.name!==this.maskLayerName&&t.isModal&&n.closeOnSide&&t.close()},t.prototype.onResize=function(e,t){var n=this.viewContent;this.maskLayer.size(e,t);for(var o=n.numChildren-1;o>-1;o--){var r=n.getChildAt(o);r.name!==this.maskLayerName&&(r.isPopupCenter&&this.centerDialog(r),r.onResize&&r.onResize(e,t))}this.checkMask()},t.prototype.centerDialog=function(e){e.x=Math.round((Laya.stage.width-e.width>>1)+e.pivotX),e.y=Math.round((Laya.stage.height-e.height>>1)+e.pivotY)},t.prototype.clearDialogEffect=function(e){Laya.timer.clear(e,e.close),e._effectTween&&(d.clear(e._effectTween),e._effectTween=null)},t.prototype.checkMask=function(){var e=this.viewContent;this.maskLayer.removeSelf();for(var t=e.numChildren-1;t>-1;t--){var n=e.getChildAt(t),o=this.getDialogConfig(n);if(n&&n.isModal)return this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,e.width,e.height,o.shadowColor),this.maskLayer.alpha=o.shadowAlpha,void l.default.addViewAt("Dialog",this.maskLayer,t)}0===e.numChildren&&l.default.setViewVisible("Dialog",!1)},t.prototype.openDialog=function(e,n,o,r){return void 0===r&&(r=!1),a(this,void 0,void 0,function(){var i,a,u,c,d=this;return s(this,function(s){switch(s.label){case 0:return r?(i=this.wait_open_dialog_map.get(e),a=void 0,i?[4,i.then(function(e){return e})]:[3,2]):[3,4];case 1:return a=s.sent(),[3,3];case 2:(u=this.dialog_list.find(function(t){return t.url===e}))&&(a=u.dialog),s.label=3;case 3:if(a)return a.onMounted.apply(a,n),[2,a];s.label=4;case 4:return c=new Promise(function(r,i){var a=l.default.getViewByPool("function"==typeof e?e.name:e);if(a)return n&&a.onMounted.apply(a,n),d.openDialogByClass(e,o,a),r(a);"string"!=typeof e?"function"==typeof e&&(a=new e,n&&a.onMounted.apply(a,n),a.once("onViewCreated",t,function(){return d.openDialogByClass(e,o,a),r(a)})):f.default.loadScene("Dialog",e,function(t){d.openDialogByData(e,n,o,t).then(function(e){r(e)})})}),this.wait_open_dialog_map.set(e,c.then(function(t){return d.wait_open_dialog_map.delete(e),t})),[4,c];case 5:return[2,s.sent()]}})})},t.prototype.openDialogByData=function(e,t,n,o){var r=this;return new Promise(function(i,a){if(!o)throw new Error('Can not find "Dialog":'+e);if(!o.props)throw new Error('"Dialog" data is error:'+e);var s=o.props.runtime?o.props.runtime:o.type,u=Laya.ClassUtils.getClass(s);l.default.createView(o,u,e,t).then(function(t){r.openDialogByClass(e,n,t),i(t)})})},t.prototype.openDialogByClass=function(e,t,n){Laya.timer.callLater(this,function(){l.default.setViewVisible("Dialog",!0)}),this.clearDialogEffect(n);var o=i({},c.DEFAULT_CONFIG,n.config,t);this.dialog_list.push({dialog:n,config:o,url:e}),l.default.addView("Dialog",n),n.isPopupCenter&&this.centerDialog(n),o.closeOther&&this.closeAll(),n.group&&o.closeByGroup&&this.closeDialogsByGroup(n.group),n.name&&o.closeByName&&this.closeDialogByName(n.name),(n.isModal||this.viewContent._getBit(32))&&Laya.timer.callLater(this,this.checkMask),n.onResize&&(n.scale(1,1),n.onResize()),n.isShowEffect&&null!=n.popupEffect?n.popupEffect.runWith(n):this.doOpen(n)},t.prototype.doOpen=function(e){var t=this.getDialogConfig(e);t.autoClose&&Laya.timer.once(t.autoClose,e,e.close)},t.prototype.close=function(e){this.clearDialogEffect(e),null!=e.closeEffect&&e.closeEffect instanceof Laya.Handler?e.closeEffect.runWith([e]):this.doClose(e)},t.prototype.doClose=function(t){var n=this.dialog_list;if(t.name!==this.maskLayerName){e.prototype.doClose.call(this,t),t.autoDestroyAtClosed||l.default.recoverView(t);for(var o=0,r=n.entries();o<r.length;o++){var i=r[o],a=i[0];i[1].dialog===t&&n.splice(a,1)}Laya.timer.callLater(this,this.checkMask)}else t.removeSelf()},t.prototype.closeAll=function(){for(var e=this.viewContent,t=e.numChildren-1;t>-1;t--){var n=e.getChildAt(t);this.close(n)}},t.prototype.closeDialogByName=function(e){if(e)for(var t=this.viewContent,n=t.numChildren-1;n>-1;n--){var o=t.getChildAt(n);if(o.name==e){this.close(o);break}}},t.prototype.closeDialogsByGroup=function(e){for(var t=this.viewContent,n=t.numChildren-1;n>-1;n--){var o=t.getChildAt(n);o&&o.group===e&&this.close(o)}},t.prototype.getDialogsByGroup=function(e){for(var t=this.viewContent,n=[],o=t.numChildren-1;o>-1;o--){var r=t.getChildAt(o);r&&r.group===e&&n.push(r)}return n},t.prototype.getDialogByName=function(e){for(var t=this.viewContent,n=t.numChildren-1;n>-1;n--){var o=t.getChildAt(n);if(o&&o.name===e)return o}},t}(Laya.DialogManager);t.DialogManager=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CONFIG={closeOther:!1,closeOnSide:!1,closeByGroup:!1,closeByName:!1,shadowAlpha:.5,shadowColor:"#000000",autoClose:!1,useExit:!0}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(14)),i=o(n(15)),a=o(n(16)),s=o(n(17)),u=o(n(18)),l=o(n(19)),c=o(n(20));t.default={createSkeleton:r.default,extend:i.default,cutStr:a.default,getStringLength:s.default,formatTime:u.default,formatMoney:l.default,getHtmlElementSize:c.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){t=t||30,n=n||0;var o=Laya.loader.getRes(e+".png"),r=Laya.loader.getRes(e+".sk");if(!o||!r)return null;var i=new Laya.Templet;return i.parseData(o,r,t),i.buildArmature(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){var e={},t=e.toString,n=e.hasOwnProperty,o=n.toString,r=o.call(Object);return function(e){var i,a;return!(!e||"[object Object]"!==t.call(e)||(i=Object.getPrototypeOf(e))&&("function"!=typeof(a=n.call(i,"constructor")&&i.constructor)||o.call(a)!==r))}}();t.default=function(){var e,t,n,r,i,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[u]||{},u++),"object"!=typeof s&&(s={}),u===l&&(s=this,u--);u<l;u++)if(null!=(e=arguments[u]))for(t in e)n=s[t],s!==(r=e[t])&&(c&&r&&(o(r)||(i=Array.isArray(r)))?(i?(i=!1,a=n&&Array.isArray(n)?n:[]):a=n&&o(n)?n:{},s[t]=Utils.extend(c,a,r)):void 0!==r&&(s[t]=r));return s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=/[^\x00-\xff]/g;if((e+="").replace(n,"mm").length<=t)return e;for(var o=Math.floor(t/2);o<e.length;o++)if(e.substr(0,o).replace(n,"mm").length>=t)return e.substr(0,o)+"...";return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(""+e.replace(/[^\x00-\xff]/gi,"ox")).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t="",n=0,o=0,r=e%60;return e>60&&(o=e/60|0),o>60&&(n=o/60|0,o%=60),r>0&&(t=r+"秒"),o>0&&(t=o+"分钟"+t),n>0&&(t=n+"小时"+t),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=""),void 0===o&&(o=","),void 0===r&&(r="."),e=Number(e),isNaN(e))return null;t=isNaN(t=Math.abs(t))?2:t;var i=e<0?"-":"",a=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",s=(s=a.length)>3?s%3:0;return n+i+(s?a.substr(0,s)+o:"")+a.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+o)+(t?r+Math.abs(e-a).toFixed(t).slice(2):"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e._element._children[0];return{width:t.contextWidth,height:t.contextHeight}}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2));t.onSceneChangeBefore=function(e){r.default.sceneChangeBeforeListener.push(e)},t.onSceneChangeAfter=function(e){r.default.sceneChangeAfterListener.push(e)},t.clearListener=function(e){r.default.sceneChangeBeforeListener=r.default.sceneChangeBeforeListener.filter(function(t){return t!==e}),r.default.sceneChangeAfterListener=r.default.sceneChangeAfterListener.filter(function(t){return t!==e})}}])});